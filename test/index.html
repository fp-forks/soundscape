<!DOCTYPE html>
<html lang="en">

<head>
    <style >
        #test {
            background-color: red;
            width: 500px;
            height: 500px;
        }
        #button {
            cursor: pointer;
        }
    </style>
    </head>

<body>
  <button id = 'button'>Click me</button>
  <div id = 'test'></div>
  <div id = 'message'></div>

<script>

const ctx = new (window.AudioContext || window.webkitAudioContext)();

const buff = ctx.createBuffer(1, 32, ctx.sampleRate);
const buffSource = ctx.createBufferSource();
buffSource.buffer = buff;
buffSource.loop = false;

function changeBackground() {
    console.log("ended");
    document.getElementById('test').style.backgroundColor = 'blue';    
}

buffSource.addEventListener('ended', () => {
    console.log("ended");
    document.getElementById('test').style.backgroundColor = 'blue';    
});

// buffSource.addEventListener('onended', () => {
//     console.log("onended");
//     document.getElementById('test').style.backgroundColor = 'blue';    
// });

// buffSource.onended = function(){
//     console.log("onended");
//     document.getElementById('test').style.backgroundColor = 'blue';
// }.bind(this);

document.getElementById('button').onclick = (e) => {
    ctx.resume();
    buffSource.start();
    document.getElementById('message').innerText = "Pressed Button";
};

</script>

</body>

</html>